<div class="card-body text-center">


    <div class="modal fade" id="exampleModal" role="dialog" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Agregar un nuevo Usuario</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body text-start">
                    <p>Todos los campos son requeridos.</p>
                    <form action="/controlenvases/newuser" accept-charset="utf-8" method="POST">
                        <div class="mb-3">
                              <label for="nombre" class="form-label">Nombre:</label>
                              <input type="text" name="nombre" id="nombre" placeholder="Nombre" class="form-control" required>
                            
                        </div>
                        <div class="mb-3">
                             <label for="apellidop" class="form-label">Apellido Paterno:</label>
                             <input type="text" name="apellidop" id="apellidop" placeholder="Apellido Paterno" class="form-control" required>
                            
                        </div>
                        <div class="mb-3">
                              <label for="apellidom" class="form-label">Apellido Materno:</label>
                              <input type="text" name="apellidom" id="apellidom" placeholder="Apellido Materno" class="form-control" required>
                        </div>
                        <div class="mb-3">
                          <label for="nusuario" class="form-label">Nombre de Usuario:</label>
                          <input type="text" name="nusuario" id="nusuario"placeholder="Nombre de Usuario" class="form-control" required>
                        </div>
                        <div class="mb-3">
                            <label for="password" class="form-label">Contraseña:</label>
                            <input type="password" id="password" name="password" placeholder="Contraseña" class="form-control" required>
                        </div>
                        <div class="mb-3">
                            <label for="rol" class="form-label">Tipo de Usuario:</label>
                             <select name="rol" id="rol" class="form-select" required>
                                    <option value="ADMINISTRADOR">ADMINISTRADOR</option>
                                    <option value="USUARIO">USUARIO</option>
                             </select>
                        </div>
                    
                        <div class="mb-3">
                            <button type="submit" class="btn btn-primary">Agregar</button>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                </div>
            </div>
        </div>
    </div>
</div>

{{!-- Modal para editar --}}
<div class="card-body text-center">


    <div class="modal fade" id="editarModalUsuario" role="dialog" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Editar un Usuario</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body text-start">
                    <p>Todos los campos son requeridos.</p>
                    <form action="/controlenvases/edituser" accept-charset="utf-8" method="POST">
                      <div class="mb-3">
                              <label for="ideditar" class="form-label">ID:</label>
                              <input type="text" name="ideditar" id="ideditar" placeholder="ID Usuario" class="form-control" required>
                            
                        </div>
                        <div class="mb-3">
                              <label for="nombreeditar" class="form-label">Nombre:</label>
                              <input type="text" name="nombreeditar" id="nombreeditar" placeholder="Nombre" class="form-control" required>
                            
                        </div>
                        <div class="mb-3">
                             <label for="apellidopeditar" class="form-label">Apellido Paterno:</label>
                             <input type="text" name="apellidopeditar" id="apellidopeditar" placeholder="Apellido Paterno" class="form-control" required>
                            
                        </div>
                        <div class="mb-3">
                              <label for="apellidomeditar" class="form-label">Apellido Materno:</label>
                              <input type="text" name="apellidomeditar" id="apellidomeditar" placeholder="Apellido Materno" class="form-control" required>
                        </div>
                        <div class="mb-3">
                          <label for="nusuarioeditar" class="form-label">Nombre de Usuario:</label>
                          <input type="text" name="nusuarioeditar" id="nusuarioeditar"placeholder="Nombre de Usuario" class="form-control" required>
                        </div>
                        <div class="mb-3">
                            <label for="passwordeditar" class="form-label">Contraseña:</label>
                            <input type="text" id="passwordeditar" name="passwordeditar" placeholder="Contraseña" class="form-control" required>
                        </div>
                        <div class="mb-3">
                            <label for="roleditar" class="form-label">Tipo de Usuario:</label>
                             <select name="roleditar" id="roleditar" class="form-select" required>
                                    <option value="ADMINISTRADOR">ADMINISTRADOR</option>
                                    <option value="USUARIO">USUARIO</option>
                             </select>
                        </div>
                    
                        <div class="mb-3">
                            <button type="submit" class="btn btn-warning">Editar</button>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                </div>
            </div>
        </div>
    </div>
</div>



 <div class="content">
                <div class="container">
                    <div class="page-title">
                        <h3>Usuarios</h3>
                    </div>
                    <div class="row">
                        <div class="col-md-12 col-lg-12">
                            <div class="card">
                                <div class="card-header">Super Tiendas Rarras S.A DE C.V.</div>
                                <div class="card-body">
                                    <p class="card-title"></p>
                                    <table class="table table-hover" id="dataTables-example" width="100%">
                                        <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#exampleModal">Nuevo</button>
                                        <thead>
                                            <tr>
                                                <th>ID</th>
                                                <th>Nombre</th>
                                                <th>Apellido Paterno</th>
                                                <th>Apellido Materno</th>
                                                <th>Nombre de Usuario</th>
                                                <th>Contraseña</th>
                                                <th>Rol de Usuario</th>
                                                <th></th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                               {{#each usuarios}}
                                            
                                                <tr>
                                
                                                <td class="lettermen2" data-order="">{{id}}</td>
                                                <td class="lettermen">{{nombre}}</td>
                                                <td class="lettermen">{{apellidop}}</td>
                                                <td class="lettermen">{{apellidom}}</td>
                                                <td class="lettermen">{{nomusuario}}</td>
                                                <td class="lettermen">{{password}}</td>
                                                 <td class="lettermen">{{rol}}</td>
                                                <td class="text-end lettermen ">
                                                <a href="#" class="btn btn-outline-info btn-rounded editarModalUsuario"><i class="fas fa-pen"></i></a>
                                                <a href="#" class="btn btn-outline-danger btn-rounded deleteItemUsuario"><i class="fas fa-trash"></i></a>
                                                </td>
                                                </tr>
                                            {{/each}}
                                          
                                       
                                        </tbody>
                                        </table>
                                  
                                    
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
    </div>
<script>

    $(document).ready(function() {  
        
        $(document).on("click", ".editarModalUsuario", function(){		            
           fila = $(this).closest("tr");	        
           id = fila.find('td:eq(0)').text();
           nombre = fila.find('td:eq(1)').text();
           apellidop = fila.find('td:eq(2)').text();
           apellidom = fila.find('td:eq(3)').text();
           nomusuario = fila.find('td:eq(4)').text();
           password = fila.find('td:eq(5)').text();
           rol = fila.find('td:eq(6)').text();
           $("#ideditar").val(id);
           $("#nombreeditar").val(nombre);
           $("#apellidopeditar").val(apellidop);
           $("#apellidomeditar").val(apellidom);
           $("#nusuarioeditar").val(nomusuario);
           $("#passwordeditar").val(password);
           $("#roleditar").val(rol);
           $('#editarModalUsuario').modal('show');	
        });
        $(document).on("click", ".deleteItemUsuario", function(){

                fila = $(this).closest("tr");	        
                id = fila.find('td:eq(0)').text();
                usuario = fila.find('td:eq(4)').text();
               Swal.fire({
                title: '¿Desea eliminar el usuario'+' '+usuario+' con el ID'+' '+id+'?',
                showDenyButton: true,
                showCancelButton: false,
                confirmButtonText: 'SI',
                denyButtonText: `NO`,
            }).then((result) => {
                /* Read more about isConfirmed, isDenied below */
                if (result.isConfirmed) {
                    //Swal.fire('Saved!', '', 'success')
                    window.location.replace("/controlenvases/deleteuser/"+id);
                } else if (result.isDenied) {
                    Swal.fire('Cambios no realizados', '', 'info')
                }
            })
        
        });


    });


 
</script>